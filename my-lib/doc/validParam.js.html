<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: validParam/validParam.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: validParam/validParam.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
* @file 验证方法参数是否符合要求，依赖lodash。
* @author Joel &lt;iamjoel007@gmail.com>
* @version 0.0.1
*/

(function(win) {
    /**
    * 支持的验证类型
    */
    var validType = [
        'required',
        'object', 'obj',
        'number', 'num',
        'int',
        'bool',
        'string',
        'array', 'arr',
        'function', 'fun'
    ];

    /**
    * @global
    * @param {object|array} validArr - 要验证的参数。
    格式类似[ {value:'要要验证的值',valid:['验证类型1','验证类型2'] },{value:'',valid:[]}...]
    * @returns {array|boolean} 如果验证通过，返回true,否则返回错误信息列表
    */
    function valid(validArr) {
        var errMsgArr = [];
        if (!_.isArray(validArr)) {
            validArr = [validArr];
        }
        _.forEach(validArr, function(each, index) {
            if (each && each.valid !== undefined) {
                if (!_.isArray(each.valid)) {
                    each.valid = [each.valid];
                }
                _.forEach(each.valid, function(eachValid) {
                    var validMsg = validEach(each.value, eachValid);
                    if (validMsg !== true) {
                        errMsgArr.push('index ' + index + ': ' + validMsg);
                    }
                });
            } else {
                errMsgArr.push('index ' + index + ': invalid format!');
            }

        });
        if (errMsgArr.length === 0) {
            return true;
        } else {
            return errMsgArr;
        }
    }

    /**
    * @param {*} value - 要验证的值
    * @param {string|function} - 期望的值的符合的条件。
    若为string，则为改插件内置的验证条件，若为function，则为自定义的验证方法
    */
    function validEach(value, type) {
        var validMsg;
        var ERROR_MSG_PREFIX = 'should be ';
        if (_.isString(type)) {
            if (_.indexOf(validType, type) === -1) {
                validMsg = 'unknown validType:' + type;
            }
            switch (type) {
                case 'required':
                    validMsg = value !== undefined ? true : ERROR_MSG_PREFIX + 'not undefined';
                    break;
                case 'object':
                case 'obj':
                    validMsg = _.isObject(value) ? true : ERROR_MSG_PREFIX + 'object';
                    break;
                case 'number':
                case 'num':
                    validMsg = _.isNumber(value) ? true : ERROR_MSG_PREFIX + 'number';
                    break;
                case 'int':
                    validMsg = _.isNumber(value) && _.indexOf((value +''),'.') === -1 ? true : ERROR_MSG_PREFIX + 'number';
                    break;
                case 'bool':
                    validMsg = _.isBoolean(value) ? true : ERROR_MSG_PREFIX + 'bool';
                    break;
                case 'string':
                    validMsg = _.isString(value) ? true : ERROR_MSG_PREFIX + 'string';
                    break;
                case 'array':
                case 'arr':
                    validMsg = _.isArray(value) ? true : ERROR_MSG_PREFIX + 'array';
                    break;
                case 'function':
                case 'fun':
                    validMsg = _.isFunction(value) ? true : ERROR_MSG_PREFIX + 'function';
                    break;
            }
        } else if (_.isFunction(type)) { // 自定义验证函数
            validMsg = type(value) ? true : 'custom valid fail';
        } else {
            validMsg = 'unknown validType:' + type;
        }
        return validMsg;
    }

    win.validParam = valid;
})(this);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Global</h3><ul><li><a href="global.html#valid">valid</a></li><li><a href="global.html#生成某个范围的随机数字，包含最小值，不包含最大值">生成某个范围的随机数字，包含最小值，不包含最大值</a></li><li><a href="global.html#生成随机字母">生成随机字母</a></li><li><a href="global.html#随机取数组中的某个元素">随机取数组中的某个元素</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Tue Jun 10 2014 17:28:06 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
